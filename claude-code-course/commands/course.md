# /course — Главная команда курса

Команда запуска и продолжения курса Claude Code.

## Обработка аргументов

Если пользователь ввёл:
- `/course` — показать прогресс и продолжить
- `/course lesson N` — перейти к уроку N
- `/course practice` — запустить практику текущего урока
- `/course progress` — детальный прогресс
- `/course reset` — сбросить прогресс
- `/course help` — показать помощь

## Алгоритм

### 1. Загрузить прогресс

Используй скилл `progress-manager` для загрузки:

```bash
PROGRESS_FILE="$HOME/.claude-course/progress.json"
if [ -f "$PROGRESS_FILE" ]; then
  cat "$PROGRESS_FILE"
else
  echo '{"version":"1.0.0","current_lesson":1,"lessons":{},"completed":false}'
fi
```

### 2. Показать приветствие

**Новый пользователь** (нет файла или current_lesson=1, lessons={}):

```
# Добро пожаловать на курс Claude Code!

Освой Claude Code за 5 практических уроков — от основ до создания полноценного приложения.

## Уроки

| # | Тема | Время |
|---|------|-------|
| 1 | Основы Claude Code | ~15 мин |
| 2 | Твой первый скилл | ~20 мин |
| 3 | Агенты-помощники | ~25 мин |
| 4 | Хуки и автоматизация | ~20 мин |
| 5 | Собираем приложение | ~30 мин |

Готов начать? Скажи "да" или введи `/course lesson 1`
```

**Продолжающий пользователь** (есть прогресс):

```
# Claude Code Course

## Твой прогресс

[PROGRESS_BAR]

| # | Урок | Статус |
|---|------|--------|
| 1 | Основы Claude Code | ✓ |
| 2 | Твой первый скилл | ● в процессе |
| 3 | Агенты-помощники | ○ |
| 4 | Хуки и автоматизация | ○ |
| 5 | Собираем приложение | ○ |

**Продолжить урок 2?** Скажи "да" или выбери другой урок.
```

### 3. Генерация прогресс-бара

```
Completed: ████████░░ 2/5 (40%)
```

Формула: для каждого урока с `practice_completed: true` — один заполненный блок.

### 4. Статусы уроков

| Статус | Символ | Условие |
|--------|--------|---------|
| Завершён | ✓ | `practice_completed: true` |
| В процессе | ● | `theory_read: true` или `started_at` есть |
| Не начат | ○ | Нет записи в `lessons` |

### 5. Обработка ответа "да"

Если пользователь подтверждает:
1. Обнови прогресс: установи `started_at` для текущего урока
2. Перенаправь на `/course lesson N` где N = current_lesson

## Автосохранение прогресса

**ВАЖНО:** Сохраняй прогресс автоматически при каждом изменении состояния!

### Функция сохранения

```bash
save_progress() {
  mkdir -p "$HOME/.claude-course"
  cat > "$HOME/.claude-course/progress.json" << 'PROGRESS'
$PROGRESS_JSON
PROGRESS
}
```

### Когда сохранять

| Событие | Что обновить |
|---------|--------------|
| Начало урока | `started_at`, `current_lesson` |
| Прочитана теория | `theory_read: true` |
| Практика успешна | `practice_completed: true`, `completed_at`, `current_lesson++` |
| Практика неуспешна | `practice_attempts++` |
| Курс завершён | `completed: true` |

### Пример: начать урок 1

```bash
mkdir -p "$HOME/.claude-course"
cat > "$HOME/.claude-course/progress.json" << 'EOF'
{
  "version": "1.0.0",
  "current_lesson": 1,
  "lessons": {
    "1": {
      "started_at": "$(date -u +%Y-%m-%dT%H:%M:%SZ)",
      "theory_read": false,
      "practice_completed": false,
      "practice_attempts": 0
    }
  },
  "completed": false
}
EOF
```

### Пример: завершить практику урока 1

```bash
# Прочитай текущий прогресс, обнови и сохрани:
# - lessons.1.practice_completed = true
# - lessons.1.completed_at = now
# - current_lesson = 2
```

## Тон общения

- Дружелюбный, поддерживающий
- Используй "ты", а не "вы"
- Без излишних эмодзи (максимум 1-2 на сообщение)
- Короткие фразы, без воды

## Примеры

**Пользователь**: `/course`
**Ответ** (новый): Показать приветствие с таблицей уроков

**Пользователь**: `/course`
**Ответ** (продолжающий): Показать прогресс-бар и предложить продолжить

**Пользователь**: `/course reset`
**Ответ**: "Прогресс сброшен. Начнём сначала?" + удалить файл прогресса
