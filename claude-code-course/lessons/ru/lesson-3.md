# Урок 3: Агенты-помощники

**Время:** ~25 минут

## Цели урока

После этого урока ты будешь:
- Понимать разницу между скиллами и агентами
- Знать когда использовать агентов
- Создашь своего первого агента
- Научишься делегировать задачи

---

## Скилл vs Агент

| Скилл | Агент |
|-------|-------|
| Инструкции | Отдельный процесс |
| Работает в основном контексте | Работает параллельно |
| Для простых задач | Для сложных автономных задач |
| Читается Claude | Запускается через Task tool |

**Аналогия:**
- Скилл = записка с инструкциями ("как заваривать чай")
- Агент = помощник которому можно делегировать ("сходи завари чай")

---

## Когда использовать агента

✅ **Используй агента когда:**
- Задача требует много шагов
- Можно работать параллельно
- Задача автономная (не нужен диалог)
- Исследование большой кодовой базы

❌ **Используй скилл когда:**
- Нужен диалог с пользователем
- Простая одношаговая задача
- Важен контекст разговора

---

## Где живут агенты

```
твой-проект/
├── .claude/
│   ├── skills/
│   └── agents/
│       └── researcher.md    ← Это агент
└── src/
```

Агенты лежат в `.claude/agents/{имя}.md`

---

## Структура агента

```markdown
---
name: researcher
description: Исследует кодовую базу и отвечает на вопросы.
tools:
  - Read
  - Glob
  - Grep
model: haiku
---

# Researcher Agent

Ты — исследователь кода. Твоя задача: найти информацию в кодовой базе.

## Инструкции

1. Используй Glob для поиска файлов
2. Используй Grep для поиска по содержимому
3. Читай найденные файлы через Read
4. Формируй краткий ответ

## Формат ответа

- Список найденных файлов
- Краткое описание каждого
- Ответ на вопрос пользователя
```

### Frontmatter (обязательные поля)

| Поле | Описание |
|------|----------|
| `name` | Уникальное имя агента |
| `description` | Для чего этот агент |
| `tools` | Какие инструменты доступны |
| `model` | Модель (haiku/sonnet/opus) |

### Доступные инструменты

| Инструмент | Описание |
|------------|----------|
| `Read` | Читать файлы |
| `Write` | Создавать файлы |
| `Edit` | Редактировать файлы |
| `Glob` | Искать файлы по паттерну |
| `Grep` | Искать по содержимому |
| `Bash` | Выполнять команды |

---

## Как запустить агента

Claude запускает агентов через Task tool:

```
Пользователь: "Найди все файлы где используется функция login"

Claude: [Использует Task tool с агентом researcher]
        → Агент работает в фоне
        → Возвращает результат
```

Ты не запускаешь агента напрямую — Claude сам решает когда его использовать по описанию.

---

## Выбор модели

| Модель | Когда использовать |
|--------|-------------------|
| `haiku` | Быстрые простые задачи (поиск, подсчёт) |
| `sonnet` | Баланс скорости и качества |
| `opus` | Сложные задачи требующие рассуждений |

**Правило:** начинай с haiku, повышай если не хватает качества.

---

## Резюме

- Агенты = автономные помощники для сложных задач
- Живут в `.claude/agents/{name}.md`
- Указывай tools и model в frontmatter
- Haiku для быстрых задач, Opus для сложных

---

## Практика

**Задание:** Создай агента `file-counter` который считает файлы в проекте.

**Требования:**
1. Путь: `.claude/agents/file-counter.md`
2. Tools: Glob, Bash
3. Model: haiku (задача простая)
4. Задача: подсчитать файлы по типам (.js, .ts, .md и т.д.)

**Шаги:**
1. Создай файл `.claude/agents/file-counter.md`
2. Добавь правильный frontmatter
3. Напиши инструкции для подсчёта файлов

**Проверка:**
После создания попроси "посчитай файлы в проекте" — я должен делегировать твоему агенту.

<details>
<summary>Подсказка</summary>

```markdown
---
name: file-counter
description: Считает файлы в проекте по типам.
tools:
  - Glob
  - Bash
model: haiku
---

# File Counter Agent

Подсчитай файлы в проекте по расширениям.

## Алгоритм

1. Используй Glob с паттерном `**/*` для получения всех файлов
2. Сгруппируй по расширениям
3. Выведи таблицу:

| Тип | Количество |
|-----|------------|
| .ts | 45 |
| .md | 12 |
| ... | ... |

4. Покажи общее количество
```

</details>

Когда закончишь, скажи "готово" и я проверю результат.

---

## Проверка практики

Когда пользователь говорит "готово", выполни проверку:

```bash
# Проверка урока 3
AGENT_FILE=".claude/agents/file-counter.md"
if [ -f "$AGENT_FILE" ]; then
  # Проверяем обязательные поля frontmatter
  if head -20 "$AGENT_FILE" | grep -q "^name:" && \
     head -20 "$AGENT_FILE" | grep -q "^tools:" && \
     head -20 "$AGENT_FILE" | grep -q "^model:"; then
    echo "✓ Агент создан с правильной структурой!"
  else
    echo "✗ Файл есть, но отсутствует frontmatter (name/tools/model)"
  fi
else
  echo "✗ Файл .claude/agents/file-counter.md не найден"
fi
```

**При успехе:**
- Обнови прогресс: `practice_completed: true`
- Покажи поздравление и предложи перейти к уроку 4

**При неудаче:**
- Объясни что именно не так
- Напомни обязательные поля: name, tools, model
